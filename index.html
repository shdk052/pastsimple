<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>לימוד Past Simple - כיתה ח'</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Rubik', sans-serif;
            background-color: #f5f5f4; /* stone-100 */
        }
        /* Chart Container Styling per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .tab-btn.active {
            border-bottom: 3px solid #4f46e5; /* indigo-600 */
            color: #4f46e5;
            font-weight: 700;
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="text-stone-800">

    <!-- Chosen Palette: Warm Neutrals (Stone) with Indigo Accents for Focus/Learning -->
    
    <!-- Application Structure Plan: 
         The app is designed as an "Interactive Textbook" or Learning Dashboard.
         1. Header: Clear context.
         2. Navigation Bar: Tab-based navigation allows non-linear exploration of the topics (Usage, Time, Structure, Rules, Irregular).
         3. Dynamic Sections:
            - Intro/Usage: Text + Context.
            - Time Expressions: Visual cards.
            - Structure Lab: An interactive "Sentence Transformer" where users toggle between Positive/Negative/Question to see the grammar rules applied in real-time (V2 vs V1 + Did).
            - Spelling Rules: Filterable grid to focus on specific endings (e, y, CVC).
            - Irregular Verbs & Data: A Chart.js visualization of the "90% Regular" rule mentioned in the text, plus a searchable table.
            - Quiz Mode: To test understanding.
         Why: This structure breaks dense grammar rules into bite-sized, interactive chunks, engaging the student actively rather than passively reading.
    -->

    <!-- Visualization & Content Choices:
         1. Chart.js Doughnut: Visualizes the "90% Regular vs 10% Irregular" statistic from the source text. Goal: Show why learning rules is efficient but exceptions are key.
         2. Sentence Transformer (JS): Replaces static tables. Goal: Demonstrate the "Did + V1" rule dynamically.
         3. Spelling Cards (HTML/JS): Interactive filtering. Goal: Organize complex suffix rules.
         4. Quiz (JS): Instant feedback. Goal: Assess knowledge.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <!-- Main App Container -->
    <div class="min-h-screen flex flex-col">
        
        <!-- Header -->
        <header class="bg-white shadow-sm sticky top-0 z-50">
            <div class="max-w-5xl mx-auto px-4 py-4 flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold text-indigo-700">Past Simple <span class="text-stone-500 text-lg font-normal">| כיתה ח'</span></h1>
                </div>
                <div class="text-sm bg-indigo-50 text-indigo-800 px-3 py-1 rounded-full font-medium">
                    מדריך אינטראקטיבי
                </div>
            </div>
            
            <!-- Navigation Tabs -->
            <nav class="max-w-5xl mx-auto px-4 mt-2 overflow-x-auto">
                <div class="flex space-x-8 space-x-reverse border-b border-stone-200 min-w-max">
                    <button onclick="switchTab('intro')" class="tab-btn active px-4 py-3 text-stone-600 hover:text-indigo-600 transition-colors" id="btn-intro">מבוא ושימוש</button>
                    <button onclick="switchTab('time')" class="tab-btn px-4 py-3 text-stone-600 hover:text-indigo-600 transition-colors" id="btn-time">מילות זמן</button>
                    <button onclick="switchTab('structure')" class="tab-btn px-4 py-3 text-stone-600 hover:text-indigo-600 transition-colors" id="btn-structure">מבנה המשפט</button>
                    <button onclick="switchTab('spelling')" class="tab-btn px-4 py-3 text-stone-600 hover:text-indigo-600 transition-colors" id="btn-spelling">כללי כתיב</button>
                    <button onclick="switchTab('irregular')" class="tab-btn px-4 py-3 text-stone-600 hover:text-indigo-600 transition-colors" id="btn-irregular">פעלים יוצאי דופן</button>
                    <button onclick="switchTab('quiz')" class="tab-btn px-4 py-3 text-stone-600 hover:text-indigo-600 transition-colors" id="btn-quiz">תרגול</button>
                </div>
            </nav>
        </header>

        <!-- Main Content Area -->
        <main class="flex-grow max-w-5xl mx-auto px-4 py-8 w-full">

            <!-- SECTION 1: INTRO & USAGE -->
            <section id="intro" class="tab-content block animate-fade-in">
                <div class="bg-white rounded-2xl p-8 shadow-sm mb-6 border-t-4 border-indigo-500">
                    <h2 class="text-3xl font-bold mb-4">מתי משתמשים ב-Past Simple?</h2>
                    <p class="text-lg text-stone-600 mb-6 leading-relaxed">
                        ברוכים הבאים למדריך. הזמן הזה משמש אותנו לתאר פעולות שהחלו והסתיימו בעבר. דמיינו ציר זמן שבו הפעולה היא נקודה ברורה מאחורינו.
                    </p>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-stone-50 p-6 rounded-xl border border-stone-100">
                            <div class="text-4xl mb-3">✅</div>
                            <h3 class="text-xl font-bold mb-2">פעולה שהושלמה</h3>
                            <p class="text-stone-600 mb-2">פעולה שהתחילה ונגמרה לחלוטין בעבר.</p>
                            <div class="bg-white p-3 rounded border-r-4 border-green-500 text-stone-700 italic">
                                "I **watched** a movie last night."
                                <br><span class="text-sm text-stone-500">(ראיתי סרט אתמול בערב)</span>
                            </div>
                        </div>

                        <div class="bg-stone-50 p-6 rounded-xl border border-stone-100">
                            <div class="text-4xl mb-3">🔗</div>
                            <h3 class="text-xl font-bold mb-2">רצף פעולות</h3>
                            <p class="text-stone-600 mb-2">סדרה של פעולות שקרו אחת אחרי השנייה.</p>
                            <div class="bg-white p-3 rounded border-r-4 border-blue-500 text-stone-700 italic">
                                "She **opened** the door, **walked** in, and **sat** down."
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION 2: TIME EXPRESSIONS -->
            <section id="time" class="tab-content hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold mb-2">מילות זמן (Time Expressions)</h2>
                    <p class="text-stone-600">המילים האלו הן "הנורות האדומות" שמסמנות לנו להשתמש בעבר פשוט.</p>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Cards populated by JS -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 card-hover">
                        <h3 class="text-xl font-bold text-indigo-600 mb-2">Yesterday</h3>
                        <p class="text-stone-500 mb-3">אתמול</p>
                        <p class="text-sm bg-stone-50 p-2 rounded">We played basketball <strong>yesterday</strong>.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 card-hover">
                        <h3 class="text-xl font-bold text-indigo-600 mb-2">Last...</h3>
                        <p class="text-stone-500 mb-3">שעבר (week, month, year)</p>
                        <p class="text-sm bg-stone-50 p-2 rounded">My family traveled <strong>last summer</strong>.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 card-hover">
                        <h3 class="text-xl font-bold text-indigo-600 mb-2">Ago</h3>
                        <p class="text-stone-500 mb-3">לפני (זמן מסוים)</p>
                        <p class="text-sm bg-stone-50 p-2 rounded">It ended five minutes <strong>ago</strong>.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 card-hover">
                        <h3 class="text-xl font-bold text-indigo-600 mb-2">In (Year)</h3>
                        <p class="text-stone-500 mb-3">בשנה מסוימת בעבר</p>
                        <p class="text-sm bg-stone-50 p-2 rounded">My parents met <strong>in 1998</strong>.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 card-hover">
                        <h3 class="text-xl font-bold text-indigo-600 mb-2">When</h3>
                        <p class="text-stone-500 mb-3">כאשר (בתיאור עבר)</p>
                        <p class="text-sm bg-stone-50 p-2 rounded"><strong>When</strong> I was young...</p>
                    </div>
                </div>
            </section>

            <!-- SECTION 3: STRUCTURE LAB (INTERACTIVE) -->
            <section id="structure" class="tab-content hidden">
                <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
                    <div class="p-8 border-b border-stone-100">
                        <h2 class="text-2xl font-bold mb-4">מעבדת המשפטים 🧪</h2>
                        <p class="text-stone-600 mb-6">
                            כאן נראה איך משפט משתנה בין חיוב, שלילה ושאלה. שימו לב לחוק הברזל: <br>
                            <span class="bg-red-100 text-red-800 px-2 py-1 rounded font-bold">כשמופיע Did, הפועל חוזר לבסיס (V1)!</span>
                        </p>

                        <!-- Controls -->
                        <div class="flex flex-wrap gap-4 mb-8 p-4 bg-stone-50 rounded-lg">
                            <div class="flex-1 min-w-[200px]">
                                <label class="block text-sm font-medium text-stone-500 mb-2">בחר פועל:</label>
                                <select id="verbSelect" class="w-full p-2 rounded border border-stone-300 focus:border-indigo-500 outline-none" onchange="updateSentenceLab()">
                                    <option value="play">Play (Regular)</option>
                                    <option value="watch">Watch (Regular)</option>
                                    <option value="go">Go (Irregular)</option>
                                    <option value="eat">Eat (Irregular)</option>
                                    <option value="see">See (Irregular)</option>
                                </select>
                            </div>
                            <div class="flex-1 min-w-[200px]">
                                <label class="block text-sm font-medium text-stone-500 mb-2">סוג משפט:</label>
                                <div class="flex gap-2">
                                    <button onclick="setSentenceType('affirmative')" class="type-btn flex-1 py-2 px-4 rounded border border-stone-200 bg-white hover:bg-green-50 hover:text-green-700 hover:border-green-300 transition-all active-type" data-type="affirmative">חיובי (+)</button>
                                    <button onclick="setSentenceType('negative')" class="type-btn flex-1 py-2 px-4 rounded border border-stone-200 bg-white hover:bg-red-50 hover:text-red-700 hover:border-red-300 transition-all" data-type="negative">שלילי (-)</button>
                                    <button onclick="setSentenceType('question')" class="type-btn flex-1 py-2 px-4 rounded border border-stone-200 bg-white hover:bg-blue-50 hover:text-blue-700 hover:border-blue-300 transition-all" data-type="question">שאלה (?)</button>
                                </div>
                            </div>
                        </div>

                        <!-- Result Display -->
                        <div class="text-center py-12">
                            <div id="sentenceDisplay" class="text-3xl md:text-5xl font-bold text-stone-800 mb-4 transition-all duration-300">
                                <!-- Dynamic Sentence -->
                            </div>
                            <div id="ruleExplanation" class="text-lg text-indigo-600 font-medium">
                                <!-- Dynamic Explanation -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION 4: SPELLING RULES (EXPANDED) -->
            <section id="spelling" class="tab-content hidden">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold mb-2 text-indigo-700">כללי כתיב: פעלים רגילים (Regular Verbs)</h2>
                    <p class="text-lg text-stone-600 leading-relaxed bg-indigo-50 p-4 rounded-lg border-r-4 border-indigo-400">
                        כדי להפוך פועל רגיל לצורת העבר (V2), מוסיפים את הסיומת -ed. עם זאת, ישנם חמישה כללי כתיב שיש לשים אליהם לב כדי להימנע מטעויות איות. שימו לב במיוחד לפעולות ה"שינוי" בכרטיסיות למטה!
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <!-- Rule 1: General Rule -->
                    <div class="bg-white p-6 rounded-xl border-t-4 border-indigo-500 shadow-lg card-hover">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-bold text-xl text-indigo-700">כלל 1: הכלל הרגיל (Add -ed)</h3>
                            <span class="text-3xl">📝</span>
                        </div>
                        <p class="text-base text-stone-600 mb-3">
                            ברוב המוחלט של הפעלים הרגילים באנגלית, אין צורך לבצע שינויים מיוחדים באיות לפני הוספת הסיומת. 
                            כל מה שצריך לעשות הוא לקחת את צורת הבסיס של הפועל, שהיא ה-V1, ולהוסיף לה את שתי האותיות הקסומות: **-ed**. 
                            כלל זה חל על כ-90% מהפעלים שתפגשו בשפה, ולכן הוא הכלל הראשי והחשוב ביותר לזכור כשאתם לא מזהים אף כלל ספציפי אחר. 
                            דוגמאות בולטות נוספות לכך הן "Look" שהופך ל-"Looked" ו-"Call" שהופך ל-"Called". 
                            פשוט מוסיפים את הסיומת והופכים את הפועל לעבר פשוט באופן ישיר, ללא דאגות לגבי שינויי כתיב.
                        </p>
                        <div class="bg-stone-100 p-3 rounded font-mono text-lg flex justify-between items-center" dir="ltr">
                            <span>Walk</span> <span>➝</span> <span class="text-indigo-600 font-extrabold">Walked</span>
                        </div>
                    </div>

                    <!-- Rule 2: Ending in 'e' -->
                    <div class="bg-white p-6 rounded-xl border-t-4 border-purple-500 shadow-lg card-hover">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-bold text-xl text-purple-700">כלל 2: פעלים המסיימים ב-'e'</h3>
                            <span class="text-3xl">🔚</span>
                        </div>
                        <p class="text-base text-stone-600 mb-3">
                            כאשר פועל רגיל מסתיים כבר באות 'e' (כמו Live, Dance), אין צורך להכפיל או להוסיף 'e' נוספת כחלק מהסיומת. 
                            האות 'e' כבר קיימת בסוף המילה, וכל מה שאנחנו צריכים להוסיף כדי ליצור את צליל העבר הוא רק האות **-d**.
                            אם היינו מוסיפים `-ed` לפועל כמו "Close", היינו מקבלים "Closeed" שזו טעות כתיב וגם נשמע רע. 
                            לכן, הכלל הוא לחסוך בהקלדה ולהוסיף רק את האות החסרה: 'd', כדי לקבל "Closed".
                            זה חל על כל הפעלים הרגילים המסתיימים ב-e, לדוגמה "Love" שהופך ל-"Loved" ו-"Use" שהופך ל-"Used".
                        </p>
                        <div class="bg-stone-100 p-3 rounded font-mono text-lg flex justify-between items-center" dir="ltr">
                            <span>Live</span> <span>➝</span> <span class="text-purple-600 font-extrabold">Lived</span>
                        </div>
                    </div>

                    <!-- Rule 3: Consonant + Y -->
                    <div class="bg-white p-6 rounded-xl border-t-4 border-pink-500 shadow-lg card-hover">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-bold text-xl text-pink-700">כלל 3: אות רגילה + 'y' (החלפת Y ל-I)</h3>
                            <span class="text-3xl">✂️</span>
                        </div>
                        <p class="text-base text-stone-600 mb-3">
                            כלל זה הוא כלל ה"היפוך" הראשון שמצריך תשומת לב מיוחדת, והוא קריטי לזכירה.
                            אם הפועל מסתיים באות 'y' ולפניה מופיעה **אות רגילה** (כגון d, r, t, p), עלינו לבצע שינוי יסודי.
                            במצב זה, אנו מוחקים לחלוטין את האות 'y' ומחליפים אותה באות **'i'**. 
                            רק לאחר ההחלפה הזו, מוסיפים את סיומת העבר הרגילה: `-ed`. 
                            זכרו: אות רגילה לפני 'y' מחייבת את השינוי ל-'i', כפי שרואים בפעלים כמו "Marry" שהופך ל-"Married" ו-"Try" שהופך ל-"Tried".
                        </p>
                        <div class="bg-stone-100 p-3 rounded font-mono text-lg flex justify-between items-center" dir="ltr">
                            <span>Study</span> <span>➝</span> <span class="text-pink-600 font-extrabold">Studied</span>
                        </div>
                    </div>

                    <!-- Rule 4: CVC Doubling (1 Syllable) -->
                    <div class="bg-white p-6 rounded-xl border-t-4 border-orange-500 shadow-lg card-hover">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-bold text-xl text-orange-700">כלל 4: הכפלת אות רגילה (CVC - הברה בודדת)</h3>
                            <span class="text-3xl">✌️</span>
                        </div>
                        <p class="text-base text-stone-600 mb-3">
                            כלל זה נועד לשמור על צליל אות הניקוד הקצר של הפועל גם לאחר הוספת סיומת.
                            הוא חל על פעלים קצרים מאוד (בדרך כלל בעלי הברה אחת) שמסתיימים ברצף של אותיות: **אות רגילה - אות ניקוד - אות רגילה** (CVC).
                            כדי להבטיח שצליל אות הניקוד במרכז המילה תישאר קצרה גם אחרי הוספת הסיומת, אנו מכפילים את **האות הרגילה** האחרונה בפועל.
                            רק לאחר הכפלת האות הרגילה, אנו מוסיפים את סיומת העבר `-ed` (Stop הופך ל-Stopp-ed).
                            הכפלת האות הרגילה האחרונה היא חיונית למניעת שינוי בצליל, ולכן "Plan" הופך ל-"Planned" (ולא Planed).
                        </p>
                        <div class="bg-stone-100 p-3 rounded font-mono text-lg flex justify-between items-center" dir="ltr">
                            <span>Stop</span> <span>➝</span> <span class="text-orange-600 font-extrabold">Stopped</span>
                        </div>
                    </div>
                    
                    <!-- Rule 5: Vowel + Y (No change) -->
                    <div class="bg-white p-6 rounded-xl border-t-4 border-gray-500 shadow-lg md:col-span-2 card-hover">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-bold text-xl text-gray-700">כלל 5: אות ניקוד + 'y' (אין שינוי)</h3>
                            <span class="text-3xl">⚠️</span>
                        </div>
                        <p class="text-base text-stone-600 mb-3">
                            זהו הכלל ההפוך לכלל 3, וחשוב מאוד להבדיל ביניהם כדי להימנע מבלבול.
                            אם הפועל מסתיים באות 'y' אבל לפניה מופיעה **אות ניקוד** (a, e, i, o, u), אין צורך לבצע כל שינוי ב-'y'.
                            **אות הניקוד** שלפני ה-'y' "מגנה" עליה משינוי ל-'i', והכתיב נשאר זהה לחלוטין.
                            במקרה כזה, פשוט מוסיפים את הסיומת `-ed` באופן ישיר, כאילו מדובר בכלל הרגיל (כלל 1).
                            דוגמאות לכך הן "Enjoy" שהופך ל-"Enjoyed" ו-"Stay" שהופך ל-"Stayed". חשוב לזכור: אם יש אות ניקוד לפני Y, היא נשארת Y!
                        </p>
                        <div class="bg-stone-100 p-3 rounded font-mono text-lg flex justify-between items-center" dir="ltr">
                            <span>Play</span> <span>➝</span> <span class="text-gray-600 font-extrabold">Played</span>
                        </div>
                    </div>

                </div>
            </section>

            <!-- SECTION 5: IRREGULAR VERBS & CHART -->
            <section id="irregular" class="tab-content hidden">
                <div class="grid lg:grid-cols-3 gap-8">
                    <!-- Data Viz Column -->
                    <div class="lg:col-span-1">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-stone-100">
                            <h3 class="font-bold text-lg mb-4 text-center">התפלגות הפעלים באנגלית</h3>
                            <p class="text-sm text-stone-500 mb-4 text-center">מדוע חשוב ללמוד את הרשימה? כי השאר עובדים לפי חוקים!</p>
                            
                            <!-- Chart Container -->
                            <div class="chart-container">
                                <canvas id="verbsChart"></canvas>
                            </div>
                            <div class="mt-4 text-xs text-center text-stone-400">
                                נתון מתוך המדריך: כ-90% מהפעלים הם רגילים.
                            </div>
                        </div>

                        <!-- Special TO BE card -->
                        <div class="bg-indigo-900 text-white p-6 rounded-2xl shadow-lg mt-6">
                            <h3 class="font-bold text-xl mb-3 border-b border-indigo-700 pb-2">הפועל TO BE</h3>
                            <p class="text-indigo-200 text-sm mb-4">הוא יוצא דופן לחלוטין!</p>
                            <div class="grid grid-cols-2 gap-4 text-center">
                                <div class="bg-indigo-800 p-2 rounded">
                                    <div class="text-xs text-indigo-300">I, He, She, It</div>
                                    <div class="text-xl font-bold">WAS</div>
                                </div>
                                <div class="bg-indigo-800 p-2 rounded">
                                    <div class="text-xs text-indigo-300">We, You, They</div>
                                    <div class="text-xl font-bold">WERE</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- List Column -->
                    <div class="lg:col-span-2">
                        <div class="bg-white rounded-2xl shadow-sm overflow-hidden border border-stone-100">
                            <div class="p-6 bg-stone-50 border-b border-stone-200 flex justify-between items-center">
                                <h2 class="text-xl font-bold">רשימת פעלים חיוניים (V2)</h2>
                                <input type="text" id="verbSearch" placeholder="חפש פועל..." class="px-4 py-2 rounded-lg border border-stone-300 text-sm focus:border-indigo-500 outline-none" onkeyup="filterVerbs()">
                            </div>
                            <div class="max-h-[500px] overflow-y-auto">
                                <table class="w-full text-left">
                                    <thead class="bg-stone-100 text-stone-500 text-sm sticky top-0">
                                        <tr>
                                            <th class="p-4">V1 (Base)</th>
                                            <th class="p-4">V2 (Past)</th>
                                            <th class="p-4 text-right">תרגום</th>
                                        </tr>
                                    </thead>
                                    <tbody id="verbsTableBody" class="divide-y divide-stone-100">
                                        <!-- Populated by JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION 6: QUIZ -->
            <section id="quiz" class="tab-content hidden">
                <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-sm border border-stone-100 overflow-hidden">
                    <div class="p-8 text-center bg-indigo-600 text-white">
                        <h2 class="text-2xl font-bold">בחנו את עצמכם!</h2>
                        <p class="opacity-90">האם אתם מוכנים למבחן?</p>
                    </div>
                    
                    <div class="p-8">
                        <div id="quiz-container">
                            <!-- Question rendered here -->
                        </div>
                        <div id="quiz-feedback" class="hidden mt-4 p-4 rounded-lg text-center font-bold"></div>
                        
                        <div class="mt-8 flex justify-between items-center">
                            <div class="text-sm text-stone-500">שאלה <span id="q-current">1</span> מתוך <span id="q-total">0</span></div>
                            <button id="next-btn" onclick="nextQuestion()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed" disabled>הבא</button>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <footer class="bg-white border-t border-stone-200 mt-auto py-6">
            <div class="max-w-5xl mx-auto px-4 text-center text-stone-500 text-sm">
                <p>פותח על בסיס חומר לימוד לכיתה ח' בישראל.</p>
            </div>
        </footer>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA STORE ---
        const verbData = [
            { v1: "Go", v2: "Went", meaning: "הלך, נסע" },
            { v1: "See", v2: "Saw", meaning: "ראה" },
            { v1: "Have", v2: "Had", meaning: "היה, אכל, שתה" },
            { v1: "Do", v2: "Did", meaning: "עשה" },
            { v1: "Be", v2: "Was / Were", meaning: "היה" },
            { v1: "Write", v2: "Wrote", meaning: "כתב" },
            { v1: "Take", v2: "Took", meaning: "לקח" },
            { v1: "Eat", v2: "Ate", meaning: "אכל" },
            { v1: "Get", v2: "Got", meaning: "קיבל, השיג" },
            { v1: "Buy", v2: "Bought", meaning: "קנה" },
            { v1: "Come", v2: "Came", meaning: "בא" }
        ];

        const sentenceData = {
            play: { v1: "play", v2: "played", sub: "We", rest: "football yesterday." },
            watch: { v1: "watch", v2: "watched", sub: "I", rest: "TV last night." },
            go: { v1: "go", v2: "went", sub: "They", rest: "to the park." },
            eat: { v1: "eat", v2: "ate", sub: "She", rest: "pizza for lunch." },
            see: { v1: "see", v2: "saw", sub: "He", rest: "a bird." }
        };

        const quizQuestions = [
            { q: "I ______ to the cinema yesterday.", options: ["go", "goed", "went", "going"], ans: 2 },
            { q: "______ you finish your homework?", options: ["Did", "Do", "Does", "Were"], ans: 0 },
            { q: "She didn't ______ the movie.", options: ["liked", "like", "likes", "liking"], ans: 1 },
            { q: "They ______ happy last week.", options: ["was", "were", "are", "did"], ans: 1 },
            { q: "The baby ______ (cry) last night.", options: ["cried", "cryed", "cryd", "cries"], ans: 0 }
        ];

        // --- STATE MANAGEMENT ---
        let currentTab = 'intro';
        let currentSentenceType = 'affirmative';
        let currentQuizIndex = 0;
        let score = 0;

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            initChart();
            renderVerbsTable(verbData);
            updateSentenceLab();
            loadQuizQuestion();
            document.getElementById('q-total').innerText = quizQuestions.length;
        });

        // --- NAVIGATION ---
        function switchTab(tabId) {
            // Hide all
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(el => {
                el.classList.remove('active', 'border-b-3', 'border-indigo-600', 'text-indigo-600', 'font-bold');
                el.classList.add('text-stone-600'); // Reset style
            });

            // Show selected
            document.getElementById(tabId).classList.remove('hidden');
            const activeBtn = document.getElementById(`btn-${tabId}`);
            activeBtn.classList.add('active');
            activeBtn.classList.remove('text-stone-600');
            
            currentTab = tabId;
        }

        // --- SENTENCE LAB LOGIC ---
        function setSentenceType(type) {
            currentSentenceType = type;
            // Update buttons styling
            document.querySelectorAll('.type-btn').forEach(btn => {
                if(btn.dataset.type === type) {
                    btn.classList.add('ring-2', 'ring-indigo-500', 'bg-indigo-50', 'font-bold');
                } else {
                    btn.classList.remove('ring-2', 'ring-indigo-500', 'bg-indigo-50', 'font-bold');
                }
            });
            updateSentenceLab();
        }

        function updateSentenceLab() {
            const verbKey = document.getElementById('verbSelect').value;
            const data = sentenceData[verbKey];
            const display = document.getElementById('sentenceDisplay');
            const explain = document.getElementById('ruleExplanation');

            let html = '';
            let text = '';

            if (currentSentenceType === 'affirmative') {
                // V2 Form
                html = `${data.sub} <span class="text-green-600 border-b-4 border-green-200">${data.v2}</span> ${data.rest}`;
                text = `במשפט חיובי, הפועל הוא בצורת העבר (V2). <br> ${data.v1 === data.v2.replace('ed','') || data.v2.endsWith('ed') ? '(פועל רגיל +ed)' : '(פועל יוצא דופן!)'}`;
            } else if (currentSentenceType === 'negative') {
                // Did not + V1
                html = `${data.sub} <span class="text-red-500 font-bold">didn't</span> <span class="text-indigo-600 border-b-4 border-indigo-200">${data.v1}</span> ${data.rest}`;
                text = `במשפט שלילי, משתמשים ב-Didn't והפועל חוזר לבסיס (V1).`;
            } else {
                // Did + Subject + V1
                html = `<span class="text-blue-500 font-bold">Did</span> ${data.sub.toLowerCase()} <span class="text-indigo-600 border-b-4 border-indigo-200">${data.v1}</span> ${data.rest.replace('.','')}?`;
                text = `בשאלה, מתחילים ב-Did והפועל חוזר לבסיס (V1).`;
            }

            display.innerHTML = html;
            explain.innerHTML = text;
        }

        // --- IRREGULAR VERBS TABLE ---
        function renderVerbsTable(data) {
            const tbody = document.getElementById('verbsTableBody');
            tbody.innerHTML = '';
            data.forEach(item => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-stone-50 transition-colors";
                tr.innerHTML = `
                    <td class="p-4 font-medium text-stone-600">${item.v1}</td>
                    <td class="p-4 font-bold text-indigo-700">${item.v2}</td>
                    <td class="p-4 text-right text-stone-500">${item.meaning}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function filterVerbs() {
            const term = document.getElementById('verbSearch').value.toLowerCase();
            const filtered = verbData.filter(v => 
                v.v1.toLowerCase().includes(term) || 
                v.v2.toLowerCase().includes(term) || 
                v.meaning.includes(term)
            );
            renderVerbsTable(filtered);
        }

        // --- QUIZ LOGIC ---
        function loadQuizQuestion() {
            const qData = quizQuestions[currentQuizIndex];
            const container = document.getElementById('quiz-container');
            const feedback = document.getElementById('quiz-feedback');
            const nextBtn = document.getElementById('next-btn');

            feedback.classList.add('hidden');
            nextBtn.disabled = true;
            document.getElementById('q-current').innerText = currentQuizIndex + 1;

            let optionsHtml = '';
            qData.options.forEach((opt, idx) => {
                optionsHtml += `<button onclick="checkAnswer(${idx})" class="quiz-opt w-full text-left p-3 rounded-lg border border-stone-200 hover:bg-indigo-50 hover:border-indigo-300 transition-all mb-2">${opt}</button>`;
            });

            container.innerHTML = `
                <h3 class="text-xl font-bold mb-6" dir="ltr">${qData.q}</h3>
                <div class="grid gap-2" dir="ltr">
                    ${optionsHtml}
                </div>
            `;
        }

        function checkAnswer(selectedIdx) {
            const qData = quizQuestions[currentQuizIndex];
            const feedback = document.getElementById('quiz-feedback');
            const nextBtn = document.getElementById('next-btn');
            const opts = document.querySelectorAll('.quiz-opt');

            opts.forEach(btn => btn.disabled = true); // Disable all

            if (selectedIdx === qData.ans) {
                opts[selectedIdx].classList.add('bg-green-100', 'border-green-500', 'text-green-800');
                feedback.innerHTML = "🎉 תשובה נכונה! כל הכבוד.";
                feedback.className = "mt-4 p-4 rounded-lg text-center font-bold bg-green-100 text-green-700 block";
                score++;
            } else {
                opts[selectedIdx].classList.add('bg-red-100', 'border-red-500', 'text-red-800');
                opts[qData.ans].classList.add('bg-green-100', 'border-green-500', 'text-green-800'); // Show correct
                feedback.innerHTML = "😕 לא נורא, בפעם הבאה!";
                feedback.className = "mt-4 p-4 rounded-lg text-center font-bold bg-red-100 text-red-700 block";
            }
            nextBtn.disabled = false;
        }

        function nextQuestion() {
            currentQuizIndex++;
            if (currentQuizIndex < quizQuestions.length) {
                loadQuizQuestion();
            } else {
                // End of quiz
                const container = document.getElementById('quiz-container');
                const feedback = document.getElementById('quiz-feedback');
                feedback.classList.add('hidden');
                document.getElementById('next-btn').style.display = 'none';

                container.innerHTML = `
                    <div class="text-center py-8">
                        <div class="text-6xl mb-4">🏆</div>
                        <h3 class="text-2xl font-bold mb-2">סיימת את המבחן!</h3>
                        <p class="text-lg">הציון שלך: ${score} מתוך ${quizQuestions.length}</p>
                        <button onclick="location.reload()" class="mt-6 px-6 py-2 bg-stone-800 text-white rounded-lg">התחל מחדש</button>
                    </div>
                `;
            }
        }

        // --- CHART.JS ---
        function initChart() {
            const ctx = document.getElementById('verbsChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['פעלים רגילים (Regular)', 'יוצאי דופן (Irregular)'],
                    datasets: [{
                        data: [90, 10],
                        backgroundColor: [
                            '#4f46e5', // indigo-600
                            '#fca5a5'  // red-300
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Rubik'
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
